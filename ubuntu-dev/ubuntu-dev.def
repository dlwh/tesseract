Bootstrap: library
From: ubuntu:20.04
Stage: build

%post
    # Generic Updates
    apt-get -y update
    apt-get -y install curl git gzip less python-is-python3 python3-distutils python3-apt tar unzip vim wget

    # Install Poetry for Python Environment Management
    # curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py | python -
    # . $HOME/.poetry/env
    # poetry completions bash > /etc/bash_completion.d/poetry.bash-completion  # Add Bash Completions

    # Install Anaconda (Full) for Python Environment Management (Core Image only uses Miniconda for efficiency)
    wget https://repo.anaconda.com/archive/Anaconda3-2020.11-Linux-x86_64.sh -O ~/anaconda.sh
    /bin/bash ~/anaconda.sh -bfp /usr/local

    # Conda configuration of channels from .condarc file
    conda config --file /.condarc --add channels defaults
    conda config --file /.condarc --add channels conda-forge
    conda update conda

    # . .anaconda/bin/activate
    # conda init
    # . .bashrc
    # rm ~/anaconda.sh

%labels
    Author Siddharth Karamcheti
    Email skaramcheti@cs.stanford.edu
    Organization Pantheon-616
    Version v0.0.1

%help
    This is a default Ubuntu 20.04 container geared for Python + GPU Development, with sane defaults.

%runscript
    bash